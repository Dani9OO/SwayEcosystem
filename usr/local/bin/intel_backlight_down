#!/bin/sh

path=/sys/class/backlight/intel_backlight

brightness() {
	cat "$path"/actual_brightness
}

factor() {
	expr $(max) / 10
}

max() {
	cat "$path"/max_brightness
}

# echo "actual_brightness = $(brightness) , max_brightness = $(max) , factor = $(factor)"

echo $(( $(brightness) - $(factor) )) > "$path"/brightness

send_notification() {
	level=$(brightness)
	top=$(max)
	bar=$(seq -s "――" $(( (level * 10) / (top + ((1000 * level) / top))  )) | sed 's/[0-9]//g')
	# bar=$(( (level * 10) / (top + ((1000 * level) / top))  ))
	makoctl reload && makoctl dismiss --all && \
	notify-send -i notification-display-brightness "$bar"
}

send_notification
