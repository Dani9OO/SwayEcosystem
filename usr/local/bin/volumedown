#!/bin/bash
# requires pamixer package to read out volume

pactl set-sink-mute @DEFAULT_SINK@ 0 && amixer -D pulse sset Master 10%-

XDG_RUNTIME_DIR=/run/user/1000 paplay /usr/share/sounds/freedesktop/stereo/bell.oga

currentvolume() {
	pamixer --get-volume
}

volume=$(currentvolume)

send_notification() {
	bar=$(seq -s "" $(( $volume / 10 )) | sed 's/[0-9]//g')
	barempty=$(seq -s "" $(( (110 - $volume) / 10)) | sed 's/[0-9]//g')
	makoctl dismiss --all && \
	notify-send -i audio-volume-high-symbolic.symbolic "$bar$barempty"
}

correctly_notify() {
	if [[ $volume -lt 10 ]]; then
		makoctl dismiss --all && \
		notify-send -i audio-volume-low-symbolic.symbolic ""
	else
		send_notification
	fi
}

correctly_notify
